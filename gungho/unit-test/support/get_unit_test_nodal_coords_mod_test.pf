!-----------------------------------------------------------------------------
! (C) Crown copyright 2019 Met Office. All rights reserved.
! The file LICENCE, distributed with this code, contains details of the terms
! under which the code may be used.
!-----------------------------------------------------------------------------
! Tests the function space reference nodal co-ordinates provided for kernel
! unit testing against the ones used by function_space_mod_test.
!
! A new module has been created for use in kernel tests as the values used in
! function_space_mod_test are specifically for testing function space objects.
! These are used for testing kernels. There might be additional data needed
! for testing function spaces not needed by kernel tests. No need to pollute
! tests with unused bits and pieces.
!
module get_unit_test_nodal_coords_mod_test

  use constants_mod, only : r_def
  use pFUnit_Mod

  implicit none

  private
  public :: test_w0, test_w1, test_w2, test_w3, test_wtheta, test_w2v, test_w2h, test_wchi

contains

  @test
  subroutine test_w0()

    use get_unit_test_nodal_coords_mod, only : get_w0_nodal_coords
    use fs_test_data_mod, only : fs0k0_nodal_coords

    implicit none

    real(r_def),allocatable :: new(:,:)

    call get_w0_nodal_coords( new )
    @assertEqual( fs0k0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w0

  @test
  subroutine test_w1()

    use get_unit_test_nodal_coords_mod, only : get_w1_nodal_coords
    use fs_test_data_mod, only : fs1k0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_w1_nodal_coords( new )
    @assertEqual( fs1k0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w1

  @test
  subroutine test_w2()

    use get_unit_test_nodal_coords_mod, only : get_w2_nodal_coords
    use fs_test_data_mod, only : fs2k0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_w2_nodal_coords( new )
    @assertEqual( fs2k0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w2

  @test
  subroutine test_w3()

    use get_unit_test_nodal_coords_mod, only : get_w3_nodal_coords
    use fs_test_data_mod, only : fs3k0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_w3_nodal_coords( new )
    @assertEqual( fs3k0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w3

  @test
  subroutine test_wtheta()

    use get_unit_test_nodal_coords_mod, only : get_wtheta_nodal_coords
    use fs_test_data_mod, only : fstk0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_wtheta_nodal_coords( new )
    @assertEqual( fstk0_nodal_coords, new )
    deallocate(new)

  end subroutine test_wtheta

  @test
  subroutine test_w2v()

    use get_unit_test_nodal_coords_mod, only : get_w2v_nodal_coords
    use fs_test_data_mod, only : fs2vk0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_w2v_nodal_coords( new )
    @assertEqual( fs2vk0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w2v

  @test
  subroutine test_w2h()

    use get_unit_test_nodal_coords_mod, only : get_w2h_nodal_coords
    use fs_test_data_mod, only : fs2hk0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_w2h_nodal_coords( new )
    @assertEqual( fs2hk0_nodal_coords, new )
    deallocate(new)

  end subroutine test_w2h

  @test
  subroutine test_wchi()

    use get_unit_test_nodal_coords_mod, only : get_wchi_nodal_coords
    use fs_test_data_mod, only : fsck0_nodal_coords

    implicit none

    real(r_def), allocatable :: new(:,:)

    call get_wchi_nodal_coords( new )
    @assertEqual( fsck0_nodal_coords, new )
    deallocate(new)

  end subroutine test_wchi

end module get_unit_test_nodal_coords_mod_test
